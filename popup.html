<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Treasure Finder</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-icon">üíé</div>
            <div class="header-content">
                <h2 class="header-title">Treasure Finder</h2>
                <p class="header-subtitle">Spot & report issues</p>
            </div>
            <button class="close-btn" id="closeBtn">√ó</button>
        </div>

        <!-- Step 1: Initial Report Button -->
        <div class="step" id="step1">
            <div class="center-content">
                <button class="primary-btn" id="reportBtn">Report üì∑</button>
            </div>
        </div>

        <!-- Step 2: Screenshot Capture -->
        <div class="step hidden" id="step2">
            <div class="screenshot-container">
                <div class="screenshot-status">
                    <div class="loading-spinner" id="loadingSpinner">üì∏ Screenshot</div>
                    <button class="secondary-btn" id="skipBtn">Skip</button>
                </div>
                <canvas id="screenshotCanvas" class="hidden"></canvas>
                <div class="screenshot-preview hidden" id="screenshotPreview">
                    <img id="screenshotImg" alt="Screenshot preview">
                </div>
            </div>
        </div>

        <!-- Step 2b: Page Selection Status -->
        <div class="step hidden" id="step2b">
            <div class="page-selection-status">
                <div class="status-header">
                    <h3>Select Problem Area on Page</h3>
                    <p>Switch to the page tab and select the area with the issue</p>
                </div>
                
                <div class="status-content">
                    <div class="status-icon">üñ±Ô∏è</div>
                    <p class="status-message">Click and drag on the webpage to highlight the problem area</p>
                    <small class="status-note">The extension will automatically capture the selected area</small>
                </div>
                
                <div class="status-controls">
                    <button class="secondary-btn" id="cancelSelectionBtn">Cancel</button>
                </div>
            </div>
        </div>

        <!-- Step 3: Screenshot Confirmation -->
        <div class="step hidden" id="step3">
            <div class="screenshot-confirm">
                <div class="confirmation-header">
                    <h3>Preview Selected Area</h3>
                    <p>This is the screenshot that will be submitted</p>
                </div>
                
                <div class="url-display" id="urlDisplay"></div>
                
                <div class="screenshot-preview">
                    <img id="confirmScreenshotImg" alt="Selected area screenshot">
                </div>
                
                <div class="button-group">
                    <button class="secondary-btn" id="retakeBtn">üîÑ Retake</button>
                    <button class="primary-btn" id="nextBtn">‚úÖ Looks Good - Next</button>
                </div>
                
                <div class="preview-instructions">
                    <small>üí° Review the screenshot above. Click "Retake" to select a different area, or "Next" to continue with the form.</small>
                </div>
            </div>
        </div>

        <!-- Step 4: Issue Details Form -->
        <div class="step hidden" id="step4">
            <form id="issueForm">
                <div class="form-section">
                    <label for="description" class="form-label">Description*</label>
                    <textarea 
                        id="summary" 
                        class="form-input" 
                        placeholder="Summary&#10;What is the pain point or inconsistency?"
                        rows="3"
                        required
                    ></textarea>
                    <textarea 
                        id="task" 
                        class="form-input" 
                        placeholder="Task&#10;What were you trying to accomplish when you encountered the issue?"
                        rows="3"
                    ></textarea>
                </div>

                <div class="form-section">
                    <label class="form-label">Details (optional)</label>
                    <textarea 
                        id="solution" 
                        class="form-input" 
                        placeholder="Solution&#10;What needs to be done to solve this issue?"
                        rows="3"
                    ></textarea>
                    
                    <select id="issueType" class="form-select" title="Choose the type of UX debt based on scope and effort">
                        <option value="">Type of UX Debt</option>
                        <option value="quick-win" title="Small scope issue with clear fix, dev+designer, single sprint">Quick Win - Small scope, clear fix, single sprint</option>
                        <option value="ux-optimization" title="Local issue (single element/screen), clear solution, 1-2 sprints">UX Optimization - Local issue, clear solution, 1-2 sprints</option>
                        <option value="redesign" title="Multi-screen issue, sub-optimal workflow, solution not obvious">Redesign Opportunity - Multi-screen, sub-optimal, solution unclear</option>
                        <option value="unknown" title="Issue needs further analysis to determine appropriate category">Unknown - Needs further analysis</option>
                    </select>

                    <select id="priority" class="form-select">
                        <option value="">Priority</option>
                        <option value="P0">üî¥ P0 - Prevents/blocks key workflows (immediate resolution)</option>
                        <option value="P1">üü† P1 - Slows workflows or causes errors (prompt attention)</option>
                        <option value="P2">üü° P2 - Not ideal but usable (better UX, can wait)</option>
                    </select>

                    <select id="uxDebtCategory" class="form-select" multiple title="Select one or more types of UX debt (Ctrl/Cmd+click to select multiple)">
                        <option value="usability" title="Complex forms, nested architecture that obscures features">Usability - Navigation & interaction challenges</option>
                        <option value="visual-design" title="Inconsistent buttons, varied component sizes, mixed typography">Visual Design - Inconsistent colors, logos, typography</option>
                        <option value="accessibility" title="Low contrast, small text, poor alt text for images">Accessibility - Barriers for users with disabilities</option>
                        <option value="content" title="Inconsistent capitalization, mixed terminology, conflicting info">Content - Outdated, unclear, or inconsistent text</option>
                        <option value="performance" title="Slow loading, laggy scrolling, poor animations">Performance - Speed & responsiveness issues</option>
                    </select>
                    <div class="help-text">üí° Hold Ctrl/Cmd to select multiple categories</div>

                </div>

                <button type="submit" class="primary-btn submit-btn">Submit</button>
            </form>
        </div>

        <!-- Step 5: Success -->
        <div class="step hidden" id="step5">
            <div class="success-content">
                <h3 style="color: #4B4B51; margin-bottom: 16px;">Issue submitted!</h3>
                <p class="success-message">Thank you for helping us improve the product.</p>
                <div class="success-buttons">
                    <button class="primary-btn" id="recordAnotherBtn">Report another issue</button>
                    <button class="secondary-btn" id="viewTicketBtn">See ticket in Jira</button>
                </div>
            </div>
        </div>

        <!-- Error Message -->
        <div class="error-message hidden" id="errorMessage"></div>
        
        <!-- Loading Animation -->
        <div class="loading-overlay hidden" id="loadingOverlay">
            <div class="treasure-submission-animation">
                <!-- Circular Progress Animation -->
                <div class="circular-progress" id="circularProgress">
                    <div class="progress-ring">
                        <svg class="progress-svg" viewBox="0 0 120 120">
                            <circle class="progress-circle-bg" cx="60" cy="60" r="54"/>
                            <circle class="progress-circle-fill" cx="60" cy="60" r="54" id="progressCircle"/>
                        </svg>
                    </div>
                    <div class="progress-content">
                        <div class="progress-text" id="progressText"></div>
                    </div>
                </div>
                
                <!-- Celebration Step -->
                <div class="celebration-step hidden" id="celebrationStep">
                    <div class="celebration-emoji">üéâ</div>
                    <div class="celebration-text">Issue submitted!</div>
                </div>
            </div>
        </div>
    </div>

    <script src="jira-integration.js"></script>
    <script src="popup.js"></script>
</body>
</html>
